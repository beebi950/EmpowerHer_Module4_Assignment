create table students(
    id serial primary key,
    name text not null,
    email text not null unique,
    age integer,
    course text,
    created_at timestamp default now()
);

INSERT INTO students (name, email, age, course, created_at) VALUES
('Amit Sharma', 'amit.sharma@example.com', 22, 'Data Science', NOW() - INTERVAL '5 days'),
('Beena Reddy', 'beena.reddy@example.com', 19, 'Web Development', NOW() - INTERVAL '3 days'),
('Carlos Dsouza', 'carlos.dsouza@example.com', 25, 'Cyber Security', NOW() - INTERVAL '7 days'),
('Divya Nair', 'divya.nair@example.com', 20, 'Data Science', NOW() - INTERVAL '2 days'),
('Eshan Verma', 'eshan.verma@example.com', 23, 'Cloud Computing', NOW() - INTERVAL '1 day'),
('Fatima Khan', 'fatima.khan@example.com', 21, 'Web Development', NOW() - INTERVAL '4 days'),
('Girish Patil', 'girish.patil@example.com', 24, 'Mobile App Development', NOW() - INTERVAL '6 days'),
('Harini Iyer', 'harini.iyer@example.com', 22, 'Cyber Security', NOW() - INTERVAL '8 days'),
('Imran Sheikh', 'imran.sheikh@example.com', 26, 'Data Science', NOW() - INTERVAL '10 days'),
('Juhi Mehta', 'juhi.mehta@example.com', 20, 'Cloud Computing', NOW() - INTERVAL '9 days');

1. Count the total number of students

SELECT COUNT(*) AS total_students
FROM students;

2. Find the average age of students

SELECT AVG(age) AS average_age
FROM students;

3. Find the minimum and maximum age

SELECT 
    MIN(age) AS minimum_age,
    MAX(age) AS maximum_age
FROM students;

4. Count how many students are enrolled in each course

SELECT 
    course,
    COUNT(*) AS student_count
FROM students
GROUP BY course;

5. Count students whose age is greater than 20

SELECT COUNT(*) AS count_age_above_20
FROM students
WHERE age > 20;

6. Display course-wise student count

SELECT 
    course,
    COUNT(*) AS student_count
FROM students
GROUP BY course;

7. Display only courses where student count is greater than 1

SELECT 
    course,
    COUNT(*) AS student_count
FROM students
GROUP BY course
HAVING COUNT(*) > 1;

8.Display courses sorted by highest student count first

SELECT 
    course,
    COUNT(*) AS student_count
FROM students
GROUP BY course
ORDER BY student_count DESC;

9.Fetch the latest 3 students based on created_at

SELECT *
FROM students
ORDER BY created_at DESC
LIMIT 3;

10.Fetch the top 5 oldest students

SELECT *
FROM students
ORDER BY age DESC
LIMIT 5;

11.Fetch students enrolled in a specific course, sorted by age (descending)

SELECT *
FROM students
WHERE course = 'Web Development'
ORDER BY age DESC;